Problem Description:
Write a query to find the salaries of the employees after applying taxes. Round the salary to the nearest integer.

The tax rate is calculated for each company based on the following criteria:
-0% If the max salary of any employee in the company is less than $1000.
-24% If the max salary of any employee in the company is in the range [1000, 10000] inclusive.
-49% If the max salary of any employee in the company is greater than $10000.
Result:
-The salary after taxes = salary - salary x (taxes percentage / 100).
-Return the result ordered by company_id, and employee_id in ascending order.
-- This follows the thought process encouraged by Scaler.

salaries
Sample Input                                                                  Sample Output 
company_id | employee_id | employee_name | salary                             company_id | employee_id | employee_name | salary
-----------|-------------|---------------|--------                            -----------|-------------|---------------|--------
1          | 1           | Andrew        | 13725                              1          | 1           | Andrew        | 7000
1          | 2           | Erin          | 5366                               1          | 2           | Erin          | 2737
1          | 3           | Stanley       | 8800                               1          | 3           | Stanley       | 4488
1          | 4           | Jim           | 14609                              1          | 4           | Jim           | 7451
1          | 5           | Oscar         | 14551                              1          | 5           | Oscar         | 7421
2          | 1           | Kevin         | 100                                2          | 1           | Kevin         | 100
2          | 2           | Pam           | 800                                2          | 2           | Pam           | 800
2          | 3           | Ryan          | 600                                2          | 3           | Ryan          | 600
2          | 4           | Kelly         | 750                                2          | 4           | Kelly         | 750


Approach : 
- Select the columns company_id, employee_id, and employee_name from the salaries table.
- To get the max salary of any employee in the company, we use the max() aggregate function as a window function and in the over clause use partition by clause based on the company_id .
- Use the case statement to apply tax as according to the required mentioned in the problem statement.
- After the calculation save the column as ‘salary’ and use the round() function to round the salary to the nearest integer.
- Use the order by clause to order the output based on the columns company_id, and employee_id on the basis of position in the SELECT clause in ascending order.

Solution : 

SELECT company_id, employee_id, employee_name , 
    CASE WHEN com_max_sal < 1000 THEN salary 
        WHEN com_max_sal BETWEEN 1000 AND 10000 THEN ROUND(salary - (salary *0.24))
        ELSE ROUND(salary - (salary *0.49)) END AS salary
FROM 
(SELECT * , MAX(salary) OVER (PARTITION BY company_id) AS com_max_sal
FROM salaries) x 
ORDER BY 1, 2;
